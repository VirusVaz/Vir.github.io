
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scratch to Reveal</title>
  <style>
    body {
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #f0f0f0; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
    }
    canvas {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 2;
    }
    .hidden-text {
      position: absolute;
      font-size: 24px;
      font-weight: bold;
      color: #333;
      text-align: center;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1; /* –¢–µ–∫—Å—Ç –ø–æ–¥ –∫–∞–Ω–≤–æ–π */
    }
    .container {
      position: relative;
      width: 300px;
      height: 150px;
      overflow: hidden;
    }
  </style>
</head>
<body>
  <div class="container">
    <canvas id="scratchCanvas" width="300" height="150"></canvas>
    <div class="hidden-text">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –Ω–∞—à–ª–∏ —Å–µ–∫—Ä–µ—Ç üéâ</div>
  </div>

  <script>
    const canvas = document.getElementById('scratchCanvas');
    const ctx = canvas.getContext('2d');
    const width = canvas.width;
    const height = canvas.height;

    // –ü–æ–ª—É—á–∞–µ–º —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    const backgroundColor = getComputedStyle(document.body).backgroundColor;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–Ω–≤–∞—Å–∞ —Å —Ñ–æ–Ω–æ–º, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ñ–æ–Ω–æ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    ctx.fillStyle = backgroundColor;
    ctx.fillRect(0, 0, width, height);

    // –î–ª—è —Å—Ç–∏—Ä–∞–Ω–∏—è
    let isDrawing = false;

    const startDrawing = (e) => {
      isDrawing = true;
      scratch(e);
    };

    const endDrawing = () => {
      isDrawing = false;
      checkIfCleared();
    };

    const scratch = (e) => {
      if (!isDrawing) return;
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      ctx.globalCompositeOperation = 'destination-out'; // –£–±–∏—Ä–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
      ctx.beginPath();
      ctx.arc(x, y, 20, 0, Math.PI * 2); // –ö—Ä—É–≥ —Ä–∞–¥–∏—É—Å–æ–º 20px
      ctx.fill();
    };

    // –ü—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å–ª–∏ –±–æ–ª–µ–µ 70% —Å—Ç–µ—Ä—Ç–æ
    const checkIfCleared = () => {
      const imageData = ctx.getImageData(0, 0, width, height);
      const pixels = imageData.data;
      let transparentPixels = 0;

      for (let i = 3; i < pixels.length; i += 4) {
        if (pixels[i] === 0) transparentPixels++;
      }

      const percentage = (transparentPixels / (pixels.length / 4)) * 100;

      if (percentage > 70) {
        canvas.style.pointerEvents = 'none'; // –û—Ç–∫–ª—é—á–∏—Ç—å —Ä–∏—Å–æ–≤–∞–Ω–∏–µ
        setTimeout(() => alert('–í—ã —Å—Ç–µ—Ä–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ!'), 300);
      }
    };

    // –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –º—ã—à–∏ –∏ —Ç–∞—á-—É—Å—Ç—Ä–æ–π—Å—Ç–≤
    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', scratch);
    canvas.addEventListener('mouseup', endDrawing);
    canvas.addEventListener('mouseleave', endDrawing);

    canvas.addEventListener('touchstart', (e) => startDrawing(e.touches[0]));
    canvas.addEventListener('touchmove', (e) => {
      scratch(e.touches[0]);
      e.preventDefault();
    });
    canvas.addEventListener('touchend', endDrawing);
  </script>
</body>
</html>
